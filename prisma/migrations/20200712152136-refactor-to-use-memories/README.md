# Migration `20200712152136-refactor-to-use-memories`

This migration has been generated by ikey2244 at 7/12/2020, 3:21:36 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Post" DROP CONSTRAINT "Post_authorId_fkey"

ALTER TABLE "public"."Profile" DROP CONSTRAINT "Profile_userId_fkey"

CREATE TABLE "public"."Memory" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"id" SERIAL,
"location" text  NOT NULL ,
"title" text  NOT NULL ,
"userId" integer  NOT NULL ,
    PRIMARY KEY ("id"))

ALTER TABLE "public"."User" ALTER COLUMN "name" SET NOT NULL;

ALTER TABLE "public"."Memory" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

DROP TABLE "public"."Post";

DROP TABLE "public"."Profile";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200711183531-first-migration..20200712152136-refactor-to-use-memories
--- datamodel.dml
+++ datamodel.dml
@@ -3,31 +3,22 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
-model Post {
+model Memory {
   id        Int      @default(autoincrement()) @id
   createdAt DateTime @default(now())
+  location  String
   title     String
-  content   String?
-  published Boolean  @default(false)
-  author    User     @relation(fields: [authorId], references: [id])
-  authorId  Int
+  user      User     @relation(fields: [userId], references: [id])
+  userId    Int
 }
-model Profile {
-  id     Int     @default(autoincrement()) @id
-  bio    String?
-  user   User    @relation(fields: [userId], references: [id])
-  userId Int     @unique
-}
-
 model User {
-  id      Int      @default(autoincrement()) @id
-  email   String   @unique
-  name    String?
-  posts   Post[]
-  profile Profile?
+  id         Int      @default(autoincrement()) @id
+  email      String   @unique
+  name       String
+  memories   Memory[]
 }
```


